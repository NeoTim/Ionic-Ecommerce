{"version":3,"sources":["../../src/pages/my-order/my-order.module.ts","../../src/services/order-service.ts","../../src/pages/my-order/my-order.ts"],"names":[],"mappings":"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","file":"18.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {IonicPageModule} from 'ionic-angular';\nimport {MyOrderPage} from './my-order';\nimport {OrderService} from \"../../services/order-service\";\n\n@NgModule({\n  declarations: [MyOrderPage],\n  imports: [\n  \tIonicPageModule.forChild(MyOrderPage)\n  ],\n  entryComponents: [\n  \tMyOrderPage\n  ],\n  providers: [\n  \tOrderService\n  ]\n})\nexport class MyOrderPageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my-order/my-order.module.ts","import {Injectable} from \"@angular/core\";\nimport {Http, Headers, RequestOptions} from '@angular/http';\nimport 'rxjs/add/operator/map';\n//import 'rxjs/add/operator/mergeMap';\n//import {Observable} from 'rxjs/Observable';\n//import 'rxjs/add/observable/forkJoin';\nimport { ENV } from '@environment';\n\n@Injectable()\nexport class OrderService {\n\n  constructor(private http: Http) {\n  }\n\n  getAll(customerToken, email) {\n    const headers = new Headers({'Content-Type': 'application/json', 'Authorization': 'Bearer ' + customerToken});\n    const options = new RequestOptions({ headers: headers });   \n    \n    return this.http.get(ENV.API_ENDPOINT + 'orders/mine?searchCriteria[filter_groups][0][filters][0][field]=customer_id&searchCriteria[filter_groups][0][filters][0][value]=' + email, options)\n    .map(res => res.json())\n    .toPromise();\n  }\n\n  getThumb(sku, index) {\n    const headers = new Headers({'Content-Type': 'application/json'});\n    const options = new RequestOptions({ headers: headers });   \n    return this.http.get(ENV.API_ENDPOINT + 'products/' + sku, options)\n    .map(res => {\n      const data = res.json();\n      const image = data.custom_attributes.filter(item => {\n        return item.attribute_code === 'image';\n      });\n      return {\n        thumb: ENV.PRODUCT_IMAGE_ENDPOINT + image[0].value,\n        index: index\n      }\n    })\n    .toPromise();\n  }\n\n  cartOfProduct(cart, options) {\n    return this.http.get(ENV.API_ENDPOINT + 'products/' + cart.sku, options)\n    .map(res => {\n      const prod = res.json();\n      const customOptions = cart.product_option.extension_attributes.custom_options;\n      customOptions.map(item => {\n        const i = prod.options.map(option => {\n          return option.option_id;\n        }).indexOf(parseInt(item.option_id));\n        item.title = prod.options[i].title;\n        if(prod.options[i].values) {\n          const option_values = prod.options[i].values.filter(option => {\n            return option.option_type_id === parseInt(item.option_value);\n          });\n          item.value_title = option_values[0].title;\n        } else {\n          item.value_title = item.option_value;\n        }\n        return item;\n      });\n      const image = prod.custom_attributes.filter(attr => {\n        return attr.attribute_code === 'small_image';\n      })\n      cart['image'] = ENV.PRODUCT_IMAGE_ENDPOINT + image[0].value;\n      return cart;\n    });\n  }\n\n  getOrderDetails(customerToken, id) {\n    const headers = new Headers({'Content-Type': 'application/json', 'Authorization': 'Bearer ' + customerToken});\n    const options = new RequestOptions({ headers: headers });   \n    \n    return this.http.get(ENV.API_ENDPOINT + 'orders/mine/'+ id, options)\n    .map(res => res.json())\n    /*.mergeMap(order => {\n      return Observable.forkJoin(\n        order['items'].map((item: any) => {\n          return this.cartOfProduct(item, options);\n        })\n      )\n    }) */\n    .toPromise();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/order-service.ts","import {Component} from '@angular/core';\nimport {Storage} from '@ionic/storage';\nimport {NavController, LoadingController, IonicPage} from 'ionic-angular';\nimport {OrderService} from \"../../services/order-service\";\nimport {ENV} from '@environment';\n\n@IonicPage({name: 'my-order'})\n@Component({\n  selector: 'page-my-order',\n  templateUrl: 'my-order.html'\n})\nexport class MyOrderPage {\n  // sample data\n  public orders: any;\n  public customerToken: any;\n  private loading: any;\n  private images: any;\n  private noItems: any;\n  private currencySym: any;\n\n  constructor(public nav: NavController, public orderService: OrderService, public storage: Storage, public loadingCtrl: LoadingController) {\n    // set sample data\n    this.noItems = \"\";\n    this.currencySym = ENV.CURRENCY_SYMBOL;\n  }\n\n  ionViewCanEnter(): Promise<boolean> {\n  \treturn this.storage.get('customer_token').then(value => {\n  \t\tif(!value) {\n\t\t\tsetTimeout(()=>{    \n\t\t      this.nav.push('login');\n\t\t \t});\n  \t\t\treturn false;\n  \t\t} else {\n  \t\t\treturn true;\n  \t\t}\n  \t});\n  }\n\n  viewOrder(id) {\n  \tthis.nav.push('order-details', {orderId: id});\n  }\n\n  loadThumb(orders) {\n    this.images = {};\n    orders.map((order, orderIndex) => {\n      order.items.map((item, index) => {\n        const identity = 'thumb' + orderIndex + index;\n        this.images[identity] = null;\n        this.orderService.getThumb(item.sku, identity).then(data => {\n          this.images[data.index] = data.thumb;\n        });\n      });\n    });\n  }\n\n  ionViewDidLoad() {\n    this.storage.get('customer_token').then(token => {\n      if(token) {\n        this.storage.get('customer_id').then(id => {\n          this.customerToken = token;\n          this.loading = this.loadingCtrl.create();\n          this.loading.present();\n          this.orderService.getAll(token, id).then(data => {\n            this.loading.dismiss().then( () => {\n              this.orders = data['items'];\n              this.loadThumb(this.orders);\n            });\n          }, err => {\n          \tthis.loading.dismiss().then( () => {\n          \t\tthis.noItems = 'No orders are placed';\n          \t});\n          });\n        });\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my-order/my-order.ts"],"sourceRoot":""}